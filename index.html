<!DOCTYPE html>
<meta charset="utf-8">
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js"></script>

<style>

    .hexagon {
        fill: white;
        pointer-events: all;
    }

    .hexagon path {
        -webkit-transition: fill 250ms linear;
        transition: fill 250ms linear;
    }

    .hexagon .desert {
        fill: sandybrown;
    }

    .hexagon .wool {
        fill: lawngreen;
    }

    .hexagon .wood {
        fill: forestgreen;
    }

    .hexagon .stone {
        fill: rosybrown;
    }

    .hexagon .grain {
        fill: yellow;
    }

    .hexagon .ore {
        fill: lightgray;
    }

    .hexagon .sea {
        fill: lightskyblue;
    }

    .hexagon .harbour_wool,
    .hexagon .harbour_wood,
    .hexagon .harbour_stone,
    .hexagon .harbour_grain,
    .hexagon .harbour_ore,
    .hexagon .harbour_all {
        fill: lightskyblue;
    }

    .mesh {
        fill: none;
        stroke: #000;
        stroke-opacity: .2;
        pointer-events: none;
    }

    .border {
        fill: none;
        stroke: #000;
        stroke-width: 4px;
        pointer-events: none;
    }

    .numbers {
        font-size: 25px;
    }

</style>

<div id="app">
    <h1> Connect to Catan </h1>
    {{status}} <br>
    <input v-on:keyup.enter="connect" v-model="ip">
    <input v-on:keyup.enter="connect" v-model="port">
    <button v-on:click="connect">Connect</button> <br>

    <code>
        {{json}}
    </code>
</div>

<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>
<script>

    var json = JSON.parse("{\"model\": \"board\", \"attributes\": {\"tiles\": [{\"model\": \"tile\", \"key\": \"[1,0]\", \"attributes\": {\"type\": \"harbour_stone\", \"number\": 0, \"orientation\": \"bottom_right\", \"x\": 1, \"y\": 0}},{\"model\": \"tile\", \"key\": \"[2,0]\", \"attributes\": {\"type\": \"sea\", \"number\": 0, \"orientation\": \"none\", \"x\": 2, \"y\": 0}},{\"model\": \"tile\", \"key\": \"[3,0]\", \"attributes\": {\"type\": \"harbour_wood\", \"number\": 0, \"orientation\": \"bottom_left\", \"x\": 3, \"y\": 0}},{\"model\": \"tile\", \"key\": \"[4,0]\", \"attributes\": {\"type\": \"sea\", \"number\": 0, \"orientation\": \"none\", \"x\": 4, \"y\": 0}},{\"model\": \"tile\", \"key\": \"[1,1]\", \"attributes\": {\"type\": \"sea\", \"number\": 0, \"orientation\": \"none\", \"x\": 1, \"y\": 1}},{\"model\": \"tile\", \"key\": \"[2,1]\", \"attributes\": {\"type\": \"stone\", \"number\": 5, \"orientation\": \"none\", \"x\": 2, \"y\": 1}},{\"model\": \"tile\", \"key\": \"[3,1]\", \"attributes\": {\"type\": \"ore\", \"number\": 2, \"orientation\": \"none\", \"x\": 3, \"y\": 1}},{\"model\": \"tile\", \"key\": \"[4,1]\", \"attributes\": {\"type\": \"stone\", \"number\": 6, \"orientation\": \"none\", \"x\": 4, \"y\": 1}},{\"model\": \"tile\", \"key\": \"[5,1]\", \"attributes\": {\"type\": \"harbour_wool\", \"number\": 0, \"orientation\": \"bottom_left\", \"x\": 5, \"y\": 1}},{\"model\": \"tile\", \"key\": \"[0,2]\", \"attributes\": {\"type\": \"harbour_all\", \"number\": 0, \"orientation\": \"right\", \"x\": 0, \"y\": 2}},{\"model\": \"tile\", \"key\": \"[1,2]\", \"attributes\": {\"type\": \"wood\", \"number\": 10, \"orientation\": \"none\", \"x\": 1, \"y\": 2}},{\"model\": \"tile\", \"key\": \"[2,2]\", \"attributes\": {\"type\": \"wool\", \"number\": 9, \"orientation\": \"none\", \"x\": 2, \"y\": 2}},{\"model\": \"tile\", \"key\": \"[3,2]\", \"attributes\": {\"type\": \"wool\", \"number\": 4, \"orientation\": \"none\", \"x\": 3, \"y\": 2}},{\"model\": \"tile\", \"key\": \"[4,2]\", \"attributes\": {\"type\": \"grain\", \"number\": 3, \"orientation\": \"none\", \"x\": 4, \"y\": 2}},{\"model\": \"tile\", \"key\": \"[5,2]\", \"attributes\": {\"type\": \"sea\", \"number\": 0, \"orientation\": \"none\", \"x\": 5, \"y\": 2}},{\"model\": \"tile\", \"key\": \"[0,3]\", \"attributes\": {\"type\": \"sea\", \"number\": 0, \"orientation\": \"none\", \"x\": 0, \"y\": 3}},{\"model\": \"tile\", \"key\": \"[1,3]\", \"attributes\": {\"type\": \"ore\", \"number\": 8, \"orientation\": \"none\", \"x\": 1, \"y\": 3}},{\"model\": \"tile\", \"key\": \"[2,3]\", \"attributes\": {\"type\": \"wood\", \"number\": 11, \"orientation\": \"none\", \"x\": 2, \"y\": 3}},{\"model\": \"tile\", \"key\": \"[3,3]\", \"attributes\": {\"type\": \"desert\", \"number\": 0, \"orientation\": \"none\", \"x\": 3, \"y\": 3}},{\"model\": \"tile\", \"key\": \"[4,3]\", \"attributes\": {\"type\": \"wood\", \"number\": 5, \"orientation\": \"none\", \"x\": 4, \"y\": 3}},{\"model\": \"tile\", \"key\": \"[5,3]\", \"attributes\": {\"type\": \"grain\", \"number\": 8, \"orientation\": \"none\", \"x\": 5, \"y\": 3}},{\"model\": \"tile\", \"key\": \"[6,3]\", \"attributes\": {\"type\": \"harbour_all\", \"number\": 0, \"orientation\": \"left\", \"x\": 6, \"y\": 3}},{\"model\": \"tile\", \"key\": \"[0,4]\", \"attributes\": {\"type\": \"harbour_ore\", \"number\": 0, \"orientation\": \"right\", \"x\": 0, \"y\": 4}},{\"model\": \"tile\", \"key\": \"[1,4]\", \"attributes\": {\"type\": \"grain\", \"number\": 4, \"orientation\": \"none\", \"x\": 1, \"y\": 4}},{\"model\": \"tile\", \"key\": \"[2,4]\", \"attributes\": {\"type\": \"stone\", \"number\": 3, \"orientation\": \"none\", \"x\": 2, \"y\": 4}},{\"model\": \"tile\", \"key\": \"[3,4]\", \"attributes\": {\"type\": \"wool\", \"number\": 6, \"orientation\": \"none\", \"x\": 3, \"y\": 4}},{\"model\": \"tile\", \"key\": \"[4,4]\", \"attributes\": {\"type\": \"wool\", \"number\": 10, \"orientation\": \"none\", \"x\": 4, \"y\": 4}},{\"model\": \"tile\", \"key\": \"[5,4]\", \"attributes\": {\"type\": \"sea\", \"number\": 0, \"orientation\": \"none\", \"x\": 5, \"y\": 4}},{\"model\": \"tile\", \"key\": \"[1,5]\", \"attributes\": {\"type\": \"sea\", \"number\": 0, \"orientation\": \"none\", \"x\": 1, \"y\": 5}},{\"model\": \"tile\", \"key\": \"[2,5]\", \"attributes\": {\"type\": \"ore\", \"number\": 11, \"orientation\": \"none\", \"x\": 2, \"y\": 5}},{\"model\": \"tile\", \"key\": \"[3,5]\", \"attributes\": {\"type\": \"grain\", \"number\": 12, \"orientation\": \"none\", \"x\": 3, \"y\": 5}},{\"model\": \"tile\", \"key\": \"[4,5]\", \"attributes\": {\"type\": \"wood\", \"number\": 9, \"orientation\": \"none\", \"x\": 4, \"y\": 5}},{\"model\": \"tile\", \"key\": \"[5,5]\", \"attributes\": {\"type\": \"harbour_all\", \"number\": 0, \"orientation\": \"top_left\", \"x\": 5, \"y\": 5}},{\"model\": \"tile\", \"key\": \"[1,6]\", \"attributes\": {\"type\": \"harbour_grain\", \"number\": 0, \"orientation\": \"top_right\", \"x\": 1, \"y\": 6}},{\"model\": \"tile\", \"key\": \"[2,6]\", \"attributes\": {\"type\": \"sea\", \"number\": 0, \"orientation\": \"none\", \"x\": 2, \"y\": 6}},{\"model\": \"tile\", \"key\": \"[3,6]\", \"attributes\": {\"type\": \"harbour_all\", \"number\": 0, \"orientation\": \"top_left\", \"x\": 3, \"y\": 6}},{\"model\": \"tile\", \"key\": \"[4,6]\", \"attributes\": {\"type\": \"sea\", \"number\": 0, \"orientation\": \"none\", \"x\": 4, \"y\": 6}}], \"edges\": [{\"model\": \"edge\", \"key\": \"([2,1],[1,0])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#bc5b90\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([2,1],[2,0])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#145ac0\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([2,1],[3,1])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#6ffac7\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([2,1],[2,2])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#6ff1d2\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([2,1],[1,2])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#8bc686\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([2,1],[1,1])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#d814da\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([3,1],[2,0])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#a458b7\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([3,1],[3,0])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#1e979d\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([3,1],[4,1])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#77a1e5\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([3,1],[3,2])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#fd0007\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([3,1],[2,2])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#59a54e\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([4,1],[3,0])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#036c50\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([4,1],[4,0])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#0e0317\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([4,1],[5,1])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#be9bfb\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([4,1],[4,2])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#422064\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([4,1],[3,2])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#911472\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([1,2],[1,1])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#7013a4\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([1,2],[2,1])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#f8a60c\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([1,2],[2,2])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#6ffb34\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([1,2],[2,3])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#4c0e83\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([1,2],[1,3])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#5301fd\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([1,2],[0,2])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#47354b\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([2,2],[3,1])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#d56a77\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([2,2],[3,2])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#b7eb9f\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([2,2],[3,3])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#92a305\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([2,2],[2,3])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#84bca6\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([3,2],[4,1])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#e41419\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([3,2],[4,2])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#bf21f3\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([3,2],[4,3])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#8c3d94\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([3,2],[3,3])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#f43746\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([4,2],[5,1])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#62cb96\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([4,2],[5,2])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#fe3cbb\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([4,2],[5,3])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#87168a\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([4,2],[4,3])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#959167\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([1,3],[0,2])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#c6dca3\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([1,3],[2,3])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#07cad6\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([1,3],[1,4])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#3d6cae\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([1,3],[0,4])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#a27415\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([1,3],[0,3])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#d62366\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([2,3],[3,3])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#ff7a02\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([2,3],[2,4])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#43d065\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([2,3],[1,4])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#d30707\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([3,3],[4,3])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#b25311\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([3,3],[3,4])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#8dd13b\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([3,3],[2,4])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#e5c337\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([4,3],[5,3])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#b0312d\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([4,3],[4,4])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#674f03\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([4,3],[3,4])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#21f8b6\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([5,3],[5,2])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#8f4a56\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([5,3],[6,3])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#8b157a\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([5,3],[5,4])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#16bb6c\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([5,3],[4,4])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#37b45f\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([1,4],[2,3])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#d1f0b9\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([1,4],[2,4])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#972248\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([1,4],[2,5])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#2e0094\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([1,4],[1,5])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#3d9219\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([1,4],[0,4])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#9b7437\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([2,4],[3,3])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#83773d\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([2,4],[3,4])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#04a46b\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([2,4],[3,5])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#f6c0d8\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([2,4],[2,5])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#259b99\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([3,4],[4,3])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#ae8da2\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([3,4],[4,4])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#bf3dca\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([3,4],[4,5])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#097b4a\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([3,4],[3,5])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#672923\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([4,4],[5,3])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#281b56\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([4,4],[5,4])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#4dfb26\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([4,4],[5,5])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#ce9108\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([4,4],[4,5])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#22218c\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([2,5],[3,5])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#9e31a6\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([2,5],[2,6])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#d72e17\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([2,5],[1,6])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#a3abe7\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([2,5],[1,5])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#5e8c52\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([3,5],[4,5])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#22ca56\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([3,5],[3,6])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#799e76\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([3,5],[2,6])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#1284ab\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([4,5],[5,5])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#83f53e\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([4,5],[4,6])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#13d79c\",\"road\": true}},{\"model\": \"edge\", \"key\": \"([4,5],[3,6])\", \"attributes\": {\"player\": 9999,\"player_color\": \"#50c13f\",\"road\": true}}], \"nodes\": [{\"model\": \"node\", \"key\": \"([2,1],[2,0],[1,0])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,1]\",\"r_key\": \"[1,0]\",\"l_key\": \"[2,0]\"}},{\"model\": \"node\", \"key\": \"([2,1],[3,1],[2,0])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,1]\",\"r_key\": \"[2,0]\",\"l_key\": \"[3,1]\"}},{\"model\": \"node\", \"key\": \"([2,1],[2,2],[3,1])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,1]\",\"r_key\": \"[3,1]\",\"l_key\": \"[2,2]\"}},{\"model\": \"node\", \"key\": \"([2,1],[1,2],[2,2])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,1]\",\"r_key\": \"[2,2]\",\"l_key\": \"[1,2]\"}},{\"model\": \"node\", \"key\": \"([2,1],[1,1],[1,2])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,1]\",\"r_key\": \"[1,2]\",\"l_key\": \"[1,1]\"}},{\"model\": \"node\", \"key\": \"([2,1],[1,0],[1,1])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,1]\",\"r_key\": \"[1,1]\",\"l_key\": \"[1,0]\"}},{\"model\": \"node\", \"key\": \"([3,1],[3,0],[2,0])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,1]\",\"r_key\": \"[2,0]\",\"l_key\": \"[3,0]\"}},{\"model\": \"node\", \"key\": \"([3,1],[4,1],[3,0])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,1]\",\"r_key\": \"[3,0]\",\"l_key\": \"[4,1]\"}},{\"model\": \"node\", \"key\": \"([3,1],[3,2],[4,1])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,1]\",\"r_key\": \"[4,1]\",\"l_key\": \"[3,2]\"}},{\"model\": \"node\", \"key\": \"([3,1],[2,2],[3,2])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,1]\",\"r_key\": \"[3,2]\",\"l_key\": \"[2,2]\"}},{\"model\": \"node\", \"key\": \"([3,1],[2,1],[2,2])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,1]\",\"r_key\": \"[2,2]\",\"l_key\": \"[2,1]\"}},{\"model\": \"node\", \"key\": \"([3,1],[2,0],[2,1])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,1]\",\"r_key\": \"[2,1]\",\"l_key\": \"[2,0]\"}},{\"model\": \"node\", \"key\": \"([4,1],[4,0],[3,0])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,1]\",\"r_key\": \"[3,0]\",\"l_key\": \"[4,0]\"}},{\"model\": \"node\", \"key\": \"([4,1],[5,1],[4,0])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,1]\",\"r_key\": \"[4,0]\",\"l_key\": \"[5,1]\"}},{\"model\": \"node\", \"key\": \"([4,1],[4,2],[5,1])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,1]\",\"r_key\": \"[5,1]\",\"l_key\": \"[4,2]\"}},{\"model\": \"node\", \"key\": \"([4,1],[3,2],[4,2])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,1]\",\"r_key\": \"[4,2]\",\"l_key\": \"[3,2]\"}},{\"model\": \"node\", \"key\": \"([4,1],[3,1],[3,2])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,1]\",\"r_key\": \"[3,2]\",\"l_key\": \"[3,1]\"}},{\"model\": \"node\", \"key\": \"([4,1],[3,0],[3,1])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,1]\",\"r_key\": \"[3,1]\",\"l_key\": \"[3,0]\"}},{\"model\": \"node\", \"key\": \"([1,2],[2,1],[1,1])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[1,2]\",\"r_key\": \"[1,1]\",\"l_key\": \"[2,1]\"}},{\"model\": \"node\", \"key\": \"([1,2],[2,2],[2,1])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[1,2]\",\"r_key\": \"[2,1]\",\"l_key\": \"[2,2]\"}},{\"model\": \"node\", \"key\": \"([1,2],[2,3],[2,2])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[1,2]\",\"r_key\": \"[2,2]\",\"l_key\": \"[2,3]\"}},{\"model\": \"node\", \"key\": \"([1,2],[1,3],[2,3])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[1,2]\",\"r_key\": \"[2,3]\",\"l_key\": \"[1,3]\"}},{\"model\": \"node\", \"key\": \"([1,2],[0,2],[1,3])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[1,2]\",\"r_key\": \"[1,3]\",\"l_key\": \"[0,2]\"}},{\"model\": \"node\", \"key\": \"([1,2],[1,1],[0,2])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[1,2]\",\"r_key\": \"[0,2]\",\"l_key\": \"[1,1]\"}},{\"model\": \"node\", \"key\": \"([2,2],[3,2],[3,1])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,2]\",\"r_key\": \"[3,1]\",\"l_key\": \"[3,2]\"}},{\"model\": \"node\", \"key\": \"([2,2],[3,3],[3,2])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,2]\",\"r_key\": \"[3,2]\",\"l_key\": \"[3,3]\"}},{\"model\": \"node\", \"key\": \"([2,2],[2,3],[3,3])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,2]\",\"r_key\": \"[3,3]\",\"l_key\": \"[2,3]\"}},{\"model\": \"node\", \"key\": \"([2,2],[1,2],[2,3])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,2]\",\"r_key\": \"[2,3]\",\"l_key\": \"[1,2]\"}},{\"model\": \"node\", \"key\": \"([2,2],[2,1],[1,2])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,2]\",\"r_key\": \"[1,2]\",\"l_key\": \"[2,1]\"}},{\"model\": \"node\", \"key\": \"([3,2],[4,2],[4,1])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,2]\",\"r_key\": \"[4,1]\",\"l_key\": \"[4,2]\"}},{\"model\": \"node\", \"key\": \"([3,2],[4,3],[4,2])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,2]\",\"r_key\": \"[4,2]\",\"l_key\": \"[4,3]\"}},{\"model\": \"node\", \"key\": \"([3,2],[3,3],[4,3])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,2]\",\"r_key\": \"[4,3]\",\"l_key\": \"[3,3]\"}},{\"model\": \"node\", \"key\": \"([3,2],[2,2],[3,3])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,2]\",\"r_key\": \"[3,3]\",\"l_key\": \"[2,2]\"}},{\"model\": \"node\", \"key\": \"([3,2],[3,1],[2,2])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,2]\",\"r_key\": \"[2,2]\",\"l_key\": \"[3,1]\"}},{\"model\": \"node\", \"key\": \"([4,2],[5,2],[5,1])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,2]\",\"r_key\": \"[5,1]\",\"l_key\": \"[5,2]\"}},{\"model\": \"node\", \"key\": \"([4,2],[5,3],[5,2])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,2]\",\"r_key\": \"[5,2]\",\"l_key\": \"[5,3]\"}},{\"model\": \"node\", \"key\": \"([4,2],[4,3],[5,3])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,2]\",\"r_key\": \"[5,3]\",\"l_key\": \"[4,3]\"}},{\"model\": \"node\", \"key\": \"([4,2],[3,2],[4,3])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,2]\",\"r_key\": \"[4,3]\",\"l_key\": \"[3,2]\"}},{\"model\": \"node\", \"key\": \"([4,2],[4,1],[3,2])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,2]\",\"r_key\": \"[3,2]\",\"l_key\": \"[4,1]\"}},{\"model\": \"node\", \"key\": \"([1,3],[1,2],[0,2])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[1,3]\",\"r_key\": \"[0,2]\",\"l_key\": \"[1,2]\"}},{\"model\": \"node\", \"key\": \"([1,3],[1,4],[2,3])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[1,3]\",\"r_key\": \"[2,3]\",\"l_key\": \"[1,4]\"}},{\"model\": \"node\", \"key\": \"([1,3],[0,4],[1,4])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[1,3]\",\"r_key\": \"[1,4]\",\"l_key\": \"[0,4]\"}},{\"model\": \"node\", \"key\": \"([1,3],[0,3],[0,4])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[1,3]\",\"r_key\": \"[0,4]\",\"l_key\": \"[0,3]\"}},{\"model\": \"node\", \"key\": \"([1,3],[0,2],[0,3])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[1,3]\",\"r_key\": \"[0,3]\",\"l_key\": \"[0,2]\"}},{\"model\": \"node\", \"key\": \"([2,3],[2,2],[1,2])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,3]\",\"r_key\": \"[1,2]\",\"l_key\": \"[2,2]\"}},{\"model\": \"node\", \"key\": \"([2,3],[2,4],[3,3])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,3]\",\"r_key\": \"[3,3]\",\"l_key\": \"[2,4]\"}},{\"model\": \"node\", \"key\": \"([2,3],[1,4],[2,4])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,3]\",\"r_key\": \"[2,4]\",\"l_key\": \"[1,4]\"}},{\"model\": \"node\", \"key\": \"([2,3],[1,3],[1,4])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,3]\",\"r_key\": \"[1,4]\",\"l_key\": \"[1,3]\"}},{\"model\": \"node\", \"key\": \"([3,3],[3,2],[2,2])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,3]\",\"r_key\": \"[2,2]\",\"l_key\": \"[3,2]\"}},{\"model\": \"node\", \"key\": \"([3,3],[3,4],[4,3])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,3]\",\"r_key\": \"[4,3]\",\"l_key\": \"[3,4]\"}},{\"model\": \"node\", \"key\": \"([3,3],[2,4],[3,4])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,3]\",\"r_key\": \"[3,4]\",\"l_key\": \"[2,4]\"}},{\"model\": \"node\", \"key\": \"([3,3],[2,3],[2,4])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,3]\",\"r_key\": \"[2,4]\",\"l_key\": \"[2,3]\"}},{\"model\": \"node\", \"key\": \"([4,3],[4,2],[3,2])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,3]\",\"r_key\": \"[3,2]\",\"l_key\": \"[4,2]\"}},{\"model\": \"node\", \"key\": \"([4,3],[4,4],[5,3])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,3]\",\"r_key\": \"[5,3]\",\"l_key\": \"[4,4]\"}},{\"model\": \"node\", \"key\": \"([4,3],[3,4],[4,4])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,3]\",\"r_key\": \"[4,4]\",\"l_key\": \"[3,4]\"}},{\"model\": \"node\", \"key\": \"([4,3],[3,3],[3,4])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,3]\",\"r_key\": \"[3,4]\",\"l_key\": \"[3,3]\"}},{\"model\": \"node\", \"key\": \"([5,3],[5,2],[4,2])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[5,3]\",\"r_key\": \"[4,2]\",\"l_key\": \"[5,2]\"}},{\"model\": \"node\", \"key\": \"([5,3],[6,3],[5,2])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[5,3]\",\"r_key\": \"[5,2]\",\"l_key\": \"[6,3]\"}},{\"model\": \"node\", \"key\": \"([5,3],[5,4],[6,3])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[5,3]\",\"r_key\": \"[6,3]\",\"l_key\": \"[5,4]\"}},{\"model\": \"node\", \"key\": \"([5,3],[4,4],[5,4])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[5,3]\",\"r_key\": \"[5,4]\",\"l_key\": \"[4,4]\"}},{\"model\": \"node\", \"key\": \"([5,3],[4,3],[4,4])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[5,3]\",\"r_key\": \"[4,4]\",\"l_key\": \"[4,3]\"}},{\"model\": \"node\", \"key\": \"([1,4],[2,4],[2,3])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[1,4]\",\"r_key\": \"[2,3]\",\"l_key\": \"[2,4]\"}},{\"model\": \"node\", \"key\": \"([1,4],[2,5],[2,4])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[1,4]\",\"r_key\": \"[2,4]\",\"l_key\": \"[2,5]\"}},{\"model\": \"node\", \"key\": \"([1,4],[1,5],[2,5])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[1,4]\",\"r_key\": \"[2,5]\",\"l_key\": \"[1,5]\"}},{\"model\": \"node\", \"key\": \"([1,4],[0,4],[1,5])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[1,4]\",\"r_key\": \"[1,5]\",\"l_key\": \"[0,4]\"}},{\"model\": \"node\", \"key\": \"([1,4],[1,3],[0,4])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[1,4]\",\"r_key\": \"[0,4]\",\"l_key\": \"[1,3]\"}},{\"model\": \"node\", \"key\": \"([2,4],[3,4],[3,3])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,4]\",\"r_key\": \"[3,3]\",\"l_key\": \"[3,4]\"}},{\"model\": \"node\", \"key\": \"([2,4],[3,5],[3,4])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,4]\",\"r_key\": \"[3,4]\",\"l_key\": \"[3,5]\"}},{\"model\": \"node\", \"key\": \"([2,4],[2,5],[3,5])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,4]\",\"r_key\": \"[3,5]\",\"l_key\": \"[2,5]\"}},{\"model\": \"node\", \"key\": \"([2,4],[1,4],[2,5])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,4]\",\"r_key\": \"[2,5]\",\"l_key\": \"[1,4]\"}},{\"model\": \"node\", \"key\": \"([2,4],[2,3],[1,4])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,4]\",\"r_key\": \"[1,4]\",\"l_key\": \"[2,3]\"}},{\"model\": \"node\", \"key\": \"([3,4],[4,4],[4,3])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,4]\",\"r_key\": \"[4,3]\",\"l_key\": \"[4,4]\"}},{\"model\": \"node\", \"key\": \"([3,4],[4,5],[4,4])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,4]\",\"r_key\": \"[4,4]\",\"l_key\": \"[4,5]\"}},{\"model\": \"node\", \"key\": \"([3,4],[3,5],[4,5])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,4]\",\"r_key\": \"[4,5]\",\"l_key\": \"[3,5]\"}},{\"model\": \"node\", \"key\": \"([3,4],[2,4],[3,5])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,4]\",\"r_key\": \"[3,5]\",\"l_key\": \"[2,4]\"}},{\"model\": \"node\", \"key\": \"([3,4],[3,3],[2,4])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,4]\",\"r_key\": \"[2,4]\",\"l_key\": \"[3,3]\"}},{\"model\": \"node\", \"key\": \"([4,4],[5,4],[5,3])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,4]\",\"r_key\": \"[5,3]\",\"l_key\": \"[5,4]\"}},{\"model\": \"node\", \"key\": \"([4,4],[5,5],[5,4])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,4]\",\"r_key\": \"[5,4]\",\"l_key\": \"[5,5]\"}},{\"model\": \"node\", \"key\": \"([4,4],[4,5],[5,5])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,4]\",\"r_key\": \"[5,5]\",\"l_key\": \"[4,5]\"}},{\"model\": \"node\", \"key\": \"([4,4],[3,4],[4,5])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,4]\",\"r_key\": \"[4,5]\",\"l_key\": \"[3,4]\"}},{\"model\": \"node\", \"key\": \"([4,4],[4,3],[3,4])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,4]\",\"r_key\": \"[3,4]\",\"l_key\": \"[4,3]\"}},{\"model\": \"node\", \"key\": \"([2,5],[2,4],[1,4])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,5]\",\"r_key\": \"[1,4]\",\"l_key\": \"[2,4]\"}},{\"model\": \"node\", \"key\": \"([2,5],[2,6],[3,5])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,5]\",\"r_key\": \"[3,5]\",\"l_key\": \"[2,6]\"}},{\"model\": \"node\", \"key\": \"([2,5],[1,6],[2,6])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,5]\",\"r_key\": \"[2,6]\",\"l_key\": \"[1,6]\"}},{\"model\": \"node\", \"key\": \"([2,5],[1,5],[1,6])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[2,5]\",\"r_key\": \"[1,6]\",\"l_key\": \"[1,5]\"}},{\"model\": \"node\", \"key\": \"([3,5],[3,4],[2,4])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,5]\",\"r_key\": \"[2,4]\",\"l_key\": \"[3,4]\"}},{\"model\": \"node\", \"key\": \"([3,5],[3,6],[4,5])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,5]\",\"r_key\": \"[4,5]\",\"l_key\": \"[3,6]\"}},{\"model\": \"node\", \"key\": \"([3,5],[2,6],[3,6])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,5]\",\"r_key\": \"[3,6]\",\"l_key\": \"[2,6]\"}},{\"model\": \"node\", \"key\": \"([3,5],[2,5],[2,6])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[3,5]\",\"r_key\": \"[2,6]\",\"l_key\": \"[2,5]\"}},{\"model\": \"node\", \"key\": \"([4,5],[4,4],[3,4])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,5]\",\"r_key\": \"[3,4]\",\"l_key\": \"[4,4]\"}},{\"model\": \"node\", \"key\": \"([4,5],[4,6],[5,5])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,5]\",\"r_key\": \"[5,5]\",\"l_key\": \"[4,6]\"}},{\"model\": \"node\", \"key\": \"([4,5],[3,6],[4,6])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,5]\",\"r_key\": \"[4,6]\",\"l_key\": \"[3,6]\"}},{\"model\": \"node\", \"key\": \"([4,5],[3,5],[3,6])\", \"attributes\": {\"structure\": \"none\",\"t_key\": \"[4,5]\",\"r_key\": \"[3,6]\",\"l_key\": \"[3,5]\"}}], \"development_cards\": [\"knight\",\"knight\",\"knight\",\"knight\",\"knight\",\"knight\",\"knight\",\"knight\",\"knight\",\"knight\",\"knight\",\"knight\",\"knight\",\"knight\",\"victory_point\",\"victory_point\",\"victory_point\",\"victory_point\",\"victory_point\",\"monopoly\",\"monopoly\",\"road_building\",\"road_building\",\"year_of_plenty\",\"year_of_plenty\"]}}\n");

    var tiles = json.attributes.tiles,
        edges = json.attributes.edges,
        nodes = json.attributes.nodes;

    var width = 1050,
        height = 900,
        radius = 75;

    var topology = hexTopology(radius, width, height);

    var projection = hexProjection(radius);

    var path = d3.geo.path()
        .projection(projection);

    var svg = d3.select("body").append("svg")
        .attr("width", width)
        .attr("height", height);

    svg.append("g")
        .attr("class", "hexagon")
        .selectAll("path")
        .data(topology.objects.hexagons.geometries)
        .enter().append("path")
        .attr("d", function (d) {
            return path(topojson.feature(topology, d));
        })
        .attr("class", function (d) {
            return d.tile.attributes.type;
        });

    svg.append("g")
        .attr("class", "numbers")
        .selectAll("path")
        .data(topology.objects.hexagons.geometries)
        .enter().append("text")
        .attr("x", function (d) {
            return path.centroid(topojson.feature(topology, d))[0];
        })
        .attr("y", function (d) {
            return path.centroid(topojson.feature(topology, d))[1] - 20;
        })
        .text(function (d) {
            if (d.tile.attributes.number > 0) return d.tile.attributes.number;
            return "";
        })
        .attr("text-anchor", "middle");

    svg.append("g")
        .attr("class", "labels")
        .selectAll("path")
        .data(topology.objects.hexagons.geometries)
        .enter().append("text")
        .attr("x", function (d) {
            return path.centroid(topojson.feature(topology, d))[0];
        })
        .attr("y", function (d) {
            return path.centroid(topojson.feature(topology, d))[1];
        })
        .text(function (d) {
            return d.tile.key;
        })
        .attr("text-anchor", "middle");

    svg.append("g")
        .attr("class", "types")
        .selectAll("path")
        .data(topology.objects.hexagons.geometries)
        .enter().append("text")
        .attr("x", function (d) {
            return path.centroid(topojson.feature(topology, d))[0];
        })
        .attr("y", function (d) {
            return path.centroid(topojson.feature(topology, d))[1] + 15;
        })
        .text(function (d) {
            return d.tile.attributes.type;
        })
        .attr("text-anchor", "middle");

    svg.append("path")
        .datum(topojson.mesh(topology, topology.objects.hexagons))
        .attr("class", "mesh")
        .attr("d", path);

    svg.append("g")
        .attr("class", "nodes")
        .selectAll("path")
        .data(nodes)
        .enter().append("path")
        .attr("transform", function (d) {
            var coordinate = path.centroid(topojson.merge(topology, [
                getHexByKey(d.attributes.t_key),
                getHexByKey(d.attributes.l_key),
                getHexByKey(d.attributes.r_key)
            ]));
            return "translate(" + coordinate[0] + "," + coordinate[1] + ")";
        })
        .attr("d", function (d) {
            if (d.attributes.structure == "settlement") {
                return "M0 -10 L10 -2 L10 10 L-10 10 L-10 -2 L0 -10 Z"
            } else if (d.attributes.structure == "city") {
                return "M-12 -2 L1 -2 L1 -10 L6 -12 L11 -10 L11 12 L-12 12 L-12 -2 Z"
            }
        });

    var border = svg.append("path")
        .attr("class", "border")
        .call(redraw);

    function redraw(border) {
        border.attr("d", path(topojson.mesh(topology, topology.objects.hexagons, function (a, b) {
            if (getEdge(a.tile.key, b.tile.key)) {
                return getEdge(a.tile.key, b.tile.key).attributes.road;
            } else if (getEdge(b.tile.key, a.tile.key)) {
                return getEdge(b.tile.key, a.tile.key).attributes.road;
            }
            return false;
        })));
    }

    function hexTopology(radius, width, height) {
        var dx = radius * 2 * Math.sin(Math.PI / 3),
            dy = radius * 1.5,
            m = Math.ceil((height + radius) / dy) + 1,
            n = Math.ceil(width / dx) + 1,
            geometries = [],
            arcs = [];

        for (var j = -1; j <= m; ++j) {
            for (var i = -1; i <= n; ++i) {
                var y = j * 2, x = (i + (j & 1) / 2) * 2;
                arcs.push([[x, y - 1], [1, 1]], [[x + 1, y], [0, 1]], [[x + 1, y + 1], [-1, 1]]);
            }
        }

        for (var j = 0, q = 3; j < m; ++j, q += 6) {
            for (var i = 0; i < n; ++i, q += 3) {
                if (getTile(i - 1, j - 2)) {
                    geometries.push({
                        type: "Polygon",
                        arcs: [[q, q + 1, q + 2, ~(q + (n + 2 - (j & 1)) * 3), ~(q - 2), ~(q - (n + 2 + (j & 1)) * 3 + 2)]],
                        tile: getTile(i - 1, j - 2)
                    });
                }
            }
        }

        return {
            transform: {translate: [0, 0], scale: [1, 1]},
            objects: {hexagons: {type: "GeometryCollection", geometries: geometries}},
            arcs: arcs
        };
    }

    function getTile(x, y) {
        var key = `[${x},${y}]`;
        return tiles.find(matchKey, key);
    }

    function getEdge(a, b) {
        var key = `(${a},${b})`;
        return edges.find(matchKey, key);
    }

    function matchKey(item) {
        return item.key == this;
    }

    function getHexByKey(key) {
        return topology.objects.hexagons.geometries.find(matchTile, key)
    }

    function matchTile(item) {
        return item.tile.key == this;
    }

    function hexProjection(radius) {
        var dx = radius * 2 * Math.sin(Math.PI / 3),
            dy = radius * 1.5;
        return {
            stream: function (stream) {
                return {
                    point: function (x, y) {
                        stream.point(x * dx / 2, (y - (2 - (y & 1)) / 3) * dy / 2);
                    },
                    lineStart: function () {
                        stream.lineStart();
                    },
                    lineEnd: function () {
                        stream.lineEnd();
                    },
                    polygonStart: function () {
                        stream.polygonStart();
                    },
                    polygonEnd: function () {
                        stream.polygonEnd();
                    }
                };
            }
        };
    }

    var app = new Vue({
        el: '#app',
        data: {
            ip: 'localhost',
            port: '10007',
            status: 'NOT_CONNECTED',
            json: '',
            socket: null,
        },
        methods: {
            connect: function (event) {
                this.json = null;
                this.status = 'CONNECTING';
                this.killSocket();

                this.socket = new WebSocket("ws:" + this.ip + ":" + this.port);

                this.socket.onerror = (err) => {
                    this.status = "CONNECTION_FAILURE";
                }

                this.socket.onclose = () => {
                    this.killSocket();
                }

                this.socket.onopen = () => {
                    this.status = "CONNECTED";
                }

                this.socket.onmessage = (data) => {
                    this.json = data.data;
                    json = JSON.parse(data.data);
                }
            },
            killSocket: function () {
                if (this.socket) {
                    this.socket.close();
                    delete this.socket;
                }
            }
        }
    })
</script>
